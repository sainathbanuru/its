{% extends 'website/base.html' %}


{% block style_script %}

    <style>

        table {
          border-collapse: separate;
          border-spacing: 50px 0;
        }

        td {
          padding: 10px 0;
        }
        
        #map-canvas{
            border: 1px solid Grey;
            width:900px;
            height:400px;
        }

        .w3-btn {
        margin-bottom:10px;
            font-size: 24px;
        }

    </style>
 
    <meta charset="UTF-8">
    <!--<meta http-equiv="refresh" content="60" />-->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Weather monitoring</title>
    
    {% load staticfiles %}
    <link href="https://fonts.googleapis.com/css?family=Satisfy" rel="stylesheet">
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCyB6K1CFUQ1RwVJ-nyXxd6W0rfiIBe12Q" type="text/javascript"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>



    <script>

        var lat = 13.554653400463117;
        var lng = 80.02738224029542;
        var points = [];
        
        function yourFunction(lat, lng, fl)
        {

            var lat_matched, lng_matched, flag = 0;

            // Precison of lat, lng: 4 decimal places
            var int_lat = Math.floor( lat*10000 );
            var int_lng = Math.floor( lng*10000 );


            {% for point in points %}

                var l1 = Math.floor( {{ point.latitude }}*10000 );
                var l2 = Math.floor( {{ point.longitude }}*10000 );

                if( Math.abs( l1 - int_lat) <= 10 )
                {
                    if( Math.abs( l2 - int_lng) <= 10 )
                    {
                        lat_matched = {{point.latitude}};
                        lng_matched = {{point.longitude}};
                        flag = 1;
                        window.location.href = 'redirect/'+lat_matched+'/'+lng_matched+'/'+fl+'/'
                    }
                }


            {% endfor %}

            if(flag == 0)
                alert("Select among red circles !!");
                
        }



        function init(){    

            
            //map
            var map = new google.maps.Map(document.getElementById('map-canvas'),{
                center:{
                    lat: 13.554653400463117,
                    lng: 80.02738224029542
                },
                zoom: 13
            });


            {% for point in points %}

                // Drawing circles.
                var circle = new google.maps.Circle({
                    
                    map: map,                    
                    center: new google.maps.LatLng({{point.latitude}}, {{point.longitude}}),
                    fillColor: "#00FF00",
                    strokeColor: "red",
                    radius: 100
                });

             {% endfor %}



            //marker
            var marker = new google.maps.Marker({
                position: {
                    lat: 13.554653400463117,
                    lng: 80.02738224029542
                },

                map: map,
                draggable: true
            });


            //drraged event
            google.maps.event.addListener(marker, 'dragend', function(){
                lat = marker.getPosition().lat();
                lng = marker.getPosition().lng();

            });                
        }
        
        window.onload = init;

    </script>

{% endblock %}


{% block middle %}

    <br><br>
    <center><div id="map-canvas"></div><center>

    <center>
        <table>
            <tr>
                

                <td><div style='display:inline;'><center><a href="#"  onclick="yourFunction(lat, lng, 'temp')">
                    <center><button class="w3-btn w3-white w3-border w3-border-blue w3-round-large">Temperature</button></center></a>
                </div></td>

                <td><div style='display:inline;'><center><a href="#"  onclick="yourFunction(lat, lng, 'hum')">
                    <center><button class="w3-btn w3-white w3-border w3-border-blue w3-round-large">Humidity</button></center></a>
                </div></td>

                <td><div style='display:inline;'><center><a href="#"  onclick="yourFunction(lat, lng, 'co')">
                    <center><button class="w3-btn w3-white w3-border w3-border-blue w3-round-large">Co2</button></center></a>
                </div></td>

                <td><div style='display:inline;'><center><a href="#"  onclick="yourFunction(lat, lng, 'smoke')">
                    <center><button class="w3-btn w3-white w3-border w3-border-blue w3-round-large">Smoke</button></center></a>
                </div></td>
                


                <!--<td><div style='display:inline;'>
                    <center>
                        <script>
                            document.write('<a href = "redirect/'+lat+'/'+lng+'/temp"><button class="w3-btn w3-white w3-border w3-border-blue w3-round-large">Temperature</button></a>');
                        </script>
                    </center>
                </div></td>


                <td><div style='display:inline;'>
                    <center>
                        <script>
                            document.write('<a href = "redirect/'+lat+'/'+lng+'/hum"><button class="w3-btn w3-white w3-border w3-border-blue w3-round-large">Humidity</button></a>');
                        </script>
                    </center>
                </div></td>


                <td><div style='display:inline;'>
                    <center>
                        <script>
                            document.write('<a href = "redirect/'+lat+'/'+lng+'/co"><button class="w3-btn w3-white w3-border w3-border-blue w3-round-large">Co2</button></a>');
                        </script>
                    </center>
                </div></td>


                <td><div style='display:inline;'>
                    <center>
                        <script>
                            document.write('<a href = "redirect/'+lat+'/'+lng+'/smoke"><button class="w3-btn w3-white w3-border w3-border-blue w3-round-large">Smoke</button></a>');
                        </script>
                    </center>
                </div></td>-->

            </tr>
        </table>                    
    </center>


{% endblock %}